# ğŸ³ Multi-stage Dockerfile pour Frontend
FROM node:22-alpine AS builder

# ğŸ“ DÃ©finir le rÃ©pertoire de travail
WORKDIR /app

# ğŸ“¦ Copier package.json et package-lock.json
COPY package*.json ./

# ğŸ“¥ Installer les dÃ©pendances
RUN npm ci --only=production && npm cache clean --force

# ğŸ“‚ Copier le code source
COPY . .

# ğŸ—ï¸ Build de production
RUN npm run build

# ğŸš€ Stage de production avec nginx
FROM nginx:1.25-alpine

# ğŸ“‹ Copier la configuration nginx
COPY nginx.conf /etc/nginx/nginx.conf

# ğŸ“‚ Copier les fichiers buildÃ©s
COPY --from=builder /app/dist /usr/share/nginx/html

# ğŸ”§ Exposer le port
EXPOSE 80

# ğŸƒ Commande de dÃ©marrage
CMD ["nginx", "-g", "daemon off;"]
